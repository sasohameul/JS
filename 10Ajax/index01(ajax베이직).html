<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <script>
        // 동기=> 순차적으로 실행
        // 비동기=> 비순차적으로 실행
        /* console.log(1);
        fetch('hi.txt').then(function(response){

            response.text().then(function(text){

                console.log(text);
            })

        })

        console.log(2); */

        //2nd
        //fetch를 사용하면 promise 객체를 반환 (상태를 가지고있는 객체)
        // 1. pending = 대기 중
        // 2. fulfilled = 성공
        // 3. reject = 실패

        /*  var promise =  fetch('hi.txt');
         promise.then(콜백) //callback function을 작성하는  */

        //promise 객체 안에는 then(콜백함수)함수를 사용 할 수 있습니다.
        //hi.txt를 가져올 때, then소괄호 안에 콜백 함수를 넣어서 실행이 완료되는대로 그 결과를 콜백함수의 첫번째 매개변수에 넣어준다. 
        //콜백함수 = 콜했을 때 back 받을 약속된 함수
        /* fetch('hi.txt').then(xxx)

        function xxx(response){
            console.log(response); //data는 body부분에 있음

        } */

        //3rd
        //text()는 body에 있는 데이터를 문자열로 반환 - return: Promise객체
        //json()는 body에 있는 데이터를 Object로 변환 - return: Promise객체
        /*  fetch('hi.txt').then( function(response) {
 
             console.log(response.text()); //Promise
 
         }) */


        //4th
        /* fetch('hi.txt').then(function(response){

            console.log(response); //실행 결과에대한 정보들이 담겨있음


            if(response.status != 200){ //실행결과가 성공이 아니었다. => 실패 //200이 성공이라는 뜻
                alert('통신에 실패했습니다.');
                return;
            }

            response.text().then(function(data){

                console.log(data);

            })


        }) */

        fetch('hi.txt').
        then(function (response) {

            if (response.status != 200) {

                console.log('통신에 실패..');
                return;
            }

            return response.text(); //이 결과는 fetch 함수의 return으로 연결이 되게끔만들어짐

        }).then(function(data){
            return data;
        }).then(function(data) {
            console.log(data);
        }).catch(function(e){
            console.log(e); //에러시에 실행됨
        })
        
        







    </script>



</body>

</html>